<%- @info_box_class = 'tabs' -%>
<%- @info_box = capture do -%>
<%= Formy.tabs do |f|
  f.tab do |t|
    t.label I18n.t(:show)
    alert_if_locked(t) or t.url page_url(@page,:action=>'show')
    t.selected action?(:show) && !controller?(:wiki_page_version)
    t.class 'page_url'
  end
  if logged_in? and current_user.may?(:edit, @page)
    f.tab do |t|
      if !locked_for_me?
        t.label I18n.t(:edit)
        alert_if_locked(t) or t.url page_url(@page,:action=>'edit')
      else
        t.label I18n.t(:break_lock)
        t.url page_url(@page,:action => 'edit', :break_lock => true)
      end
      t.selected action?(:edit) || action?(:update)
      t.class 'page_url'
    end
  end
  last_change_id = "#{@wiki.version.to_i-1}-#{@wiki.version}"
  f.tab do |t|
    t.label I18n.t(:versions)
    alert_if_locked(t) or t.url page_url(@page, :action => 'version-list')
    t.selected controller?(:wiki_page_version) && !(action?(:diff) && params[:id] == last_change_id)
    t.class 'page_url'
  end
  if @wiki.version > 1
    f.tab do |t|
      t.label I18n.t(:last_change)
      alert_if_locked(t) or
        t.url page_url(@page, :action=>'version-diff', :id => last_change_id)
      t.selected controller?(:wiki_page_version) && action?(:diff) && params[:id] == last_change_id
      t.class 'page_url'
    end
  end
  f.tab do |t|
    t.label I18n.t(:print)
    alert_if_locked(t) or t.url page_url(@page,:action=>'print')
    t.class 'page_url'
  end
end -%>
<%- end -%>
