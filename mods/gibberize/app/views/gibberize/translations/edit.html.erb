<h1>Editing translation</h1>

<%= error_messages_for :translation %>

  <p>
    <b>Key</b><br />
    <%= h @translation.key.name %>
  </p>

  <p>
    <b>Language</b><br />
    <%= h @translation.language.name %>
  </p>

<% form_for(@translation) do |f| %>
  <p>
    <b>Text</b><br />
    <%= f.text_field :text %>
  </p>

  <% original = Translation.best_guess(@translation.key, crabgrass_default_language) %>
  <p>
    <b>Original</b><br />
    <%= original %>
  </p>

<% if @use_google -%>
  <p>
    <b>Google Says</b><br />
    <span id="googletranslate">Loading...</span>
  </p>

<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load("language", "1");
  function initialize() {
    google.language.translate('<%= original %>', 
                              '<%= crabgrass_default_language.code[0,2] %>', 
                              '<%= @translation.language.code[0,2] %>',
      function(result) {
        var translated = document.getElementById("googletranslate");
        if (result.translation) {
          translated.innerHTML = result.translation;
        }
      });
  };

  google.setOnLoadCallback(initialize);

</script>
<% end %>

  <p>
    <%= f.submit "Update" %>
  </p>
<% end %>

<! -- %= link_to 'Show', @translation %>
<!-- %= link_to 'Back', translations_path % -->

<%= link_to 'Back', @translation.key %>
